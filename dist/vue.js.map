{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\r\n  constructor(data) {\r\n    // Object.defineProperty 只能劫持已经存在的属性(vue里面会为此单独写一些api $set $delete)\r\n    this.walk(data);\r\n  }\r\n  walk(data) {\r\n    // 循环对象 对属性依次劫持\r\n    // \"重新定义\"属性 性能差\r\n    Object.keys(data).forEach((key) => defineReactive(data, key, data[key]));\r\n  }\r\n}\r\n\r\nexport function defineReactive(target, key, value) {\r\n  observe(value); // 对所有的对象都进行属性劫持\r\n  // 闭包 属性劫持\r\n  Object.defineProperty(target, key, {\r\n    get() {\r\n      //   console.log(value);\r\n      // 取值的时候 会执行 get\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      // 修改的时候 会执行set\r\n      if (newValue === value) return;\r\n      value = newValue;\r\n    },\r\n  });\r\n}\r\n\r\nexport function observe(data) {\r\n  // 对这个对象进行劫持\r\n  if (typeof data !== \"object\" || data == null) {\r\n    return; // 只对对象进行劫持\r\n  }\r\n  // 如果一个对象被劫持过了，那就不需要在劫持了\r\n  // （要判断一个对象是否被劫持过，可以增加一个实例，\r\n  // 用实例来判断是否被劫持过）\r\n\r\n  return new Observer(data);\r\n}\r\n","import { observe } from \"./observe/index\";\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options; // 获取所有的选项\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction proxy(vm, target, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[target][key];\r\n    },\r\n    set(newValue) {\r\n      vm[target][key] = newValue;\r\n    },\r\n  });\r\n}\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data; //data 可能是函数和对象\r\n\r\n  data = typeof data === \"function\" ? data.call(vm) : data;\r\n  vm._data = data; // 我将返回的对象放到了_data上\r\n  // 对数据进行劫持 vue2 里采用了一个 api defineProperty\r\n  observe(data);\r\n\r\n  // 将vm._data 用vm来代理就可以了\r\n  for (let key in data) {\r\n    proxy(vm, \"_data\", key);\r\n  }\r\n}\r\n","import { initState } from \"./state\";\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    // vue vm.$options 就是获取用户配置\r\n\r\n    // 我们使用 Vue 的时候 $nextTick $data $attr ....\r\n    const vm = this;\r\n    vm.$options = options;\r\n\r\n    // 初始化状态\r\n    initState(vm);\r\n  };\r\n}\r\n","import { initMixin } from \"./init\";\r\n\r\n// 将所有的方法都耦合在一起\r\nfunction Vue(options) {\r\n  this._init(options);\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["Observer","data","_classCallCheck","walk","_createClass","key","value","Object","keys","forEach","defineReactive","target","observe","defineProperty","get","set","newValue","_typeof","initState","vm","opts","$options","initData","proxy","call","_data","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAAMA,QAAQ,gBAAA,YAAA;IACZ,SAAAA,QAAAA,CAAYC,IAAI,EAAE;EAAAC,IAAAA,eAAA,OAAAF,QAAA,CAAA,CAAA;EAChB;EACA,IAAA,IAAI,CAACG,IAAI,CAACF,IAAI,CAAC,CAAA;EACjB,GAAA;IAAC,OAAAG,YAAA,CAAAJ,QAAA,EAAA,CAAA;MAAAK,GAAA,EAAA,MAAA;EAAAC,IAAAA,KAAA,EACD,SAAAH,IAAKF,CAAAA,IAAI,EAAE;EACT;EACA;QACAM,MAAM,CAACC,IAAI,CAACP,IAAI,CAAC,CAACQ,OAAO,CAAC,UAACJ,GAAG,EAAA;UAAA,OAAKK,cAAc,CAACT,IAAI,EAAEI,GAAG,EAAEJ,IAAI,CAACI,GAAG,CAAC,CAAC,CAAA;SAAC,CAAA,CAAA;EAC1E,KAAA;EAAC,GAAA,CAAA,CAAA,CAAA;EAAA,CAAA,EAAA,CAAA;EAGI,SAASK,cAAcA,CAACC,MAAM,EAAEN,GAAG,EAAEC,KAAK,EAAE;EACjDM,EAAAA,OAAO,CAACN,KAAK,CAAC,CAAC;EACf;EACAC,EAAAA,MAAM,CAACM,cAAc,CAACF,MAAM,EAAEN,GAAG,EAAE;MACjCS,GAAG,EAAA,SAAAA,MAAG;EACJ;EACA;EACA,MAAA,OAAOR,KAAK,CAAA;OACb;MACDS,GAAG,EAAA,SAAAA,GAACC,CAAAA,QAAQ,EAAE;EACZ;QACA,IAAIA,QAAQ,KAAKV,KAAK,EAAE,OAAA;EACxBA,MAAAA,KAAK,GAAGU,QAAQ,CAAA;EAClB,KAAA;EACF,GAAC,CAAC,CAAA;EACJ,CAAA;EAEO,SAASJ,OAAOA,CAACX,IAAI,EAAE;EAC5B;IACA,IAAIgB,OAAA,CAAOhB,IAAI,CAAA,KAAK,QAAQ,IAAIA,IAAI,IAAI,IAAI,EAAE;EAC5C,IAAA,OAAO;EACT,GAAA;EACA;EACA;EACA;;EAEA,EAAA,OAAO,IAAID,QAAQ,CAACC,IAAI,CAAC,CAAA;EAC3B;;ECrCO,SAASiB,SAASA,CAACC,EAAE,EAAE;EAC5B,EAAA,IAAMC,IAAI,GAAGD,EAAE,CAACE,QAAQ,CAAC;IACzB,IAAID,IAAI,CAACnB,IAAI,EAAE;MACbqB,QAAQ,CAACH,EAAE,CAAC,CAAA;EACd,GAAA;EACF,CAAA;EAEA,SAASI,KAAKA,CAACJ,EAAE,EAAER,MAAM,EAAEN,GAAG,EAAE;EAC9BE,EAAAA,MAAM,CAACM,cAAc,CAACM,EAAE,EAAEd,GAAG,EAAE;MAC7BS,GAAG,EAAA,SAAAA,MAAG;EACJ,MAAA,OAAOK,EAAE,CAACR,MAAM,CAAC,CAACN,GAAG,CAAC,CAAA;OACvB;MACDU,GAAG,EAAA,SAAAA,GAACC,CAAAA,QAAQ,EAAE;EACZG,MAAAA,EAAE,CAACR,MAAM,CAAC,CAACN,GAAG,CAAC,GAAGW,QAAQ,CAAA;EAC5B,KAAA;EACF,GAAC,CAAC,CAAA;EACJ,CAAA;EAEA,SAASM,QAAQA,CAACH,EAAE,EAAE;IACpB,IAAIlB,IAAI,GAAGkB,EAAE,CAACE,QAAQ,CAACpB,IAAI,CAAC;;EAE5BA,EAAAA,IAAI,GAAG,OAAOA,IAAI,KAAK,UAAU,GAAGA,IAAI,CAACuB,IAAI,CAACL,EAAE,CAAC,GAAGlB,IAAI,CAAA;EACxDkB,EAAAA,EAAE,CAACM,KAAK,GAAGxB,IAAI,CAAC;EAChB;IACAW,OAAO,CAACX,IAAI,CAAC,CAAA;;EAEb;EACA,EAAA,KAAK,IAAII,GAAG,IAAIJ,IAAI,EAAE;EACpBsB,IAAAA,KAAK,CAACJ,EAAE,EAAE,OAAO,EAAEd,GAAG,CAAC,CAAA;EACzB,GAAA;EACF;;EC/BO,SAASqB,SAASA,CAACC,GAAG,EAAE;EAC7BA,EAAAA,GAAG,CAACC,SAAS,CAACC,KAAK,GAAG,UAAUC,OAAO,EAAE;EACvC;;EAEA;MACA,IAAMX,EAAE,GAAG,IAAI,CAAA;MACfA,EAAE,CAACE,QAAQ,GAAGS,OAAO,CAAA;;EAErB;MACAZ,SAAS,CAACC,EAAE,CAAC,CAAA;KACd,CAAA;EACH;;ECVA;EACA,SAASQ,GAAGA,CAACG,OAAO,EAAE;EACpB,EAAA,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC,CAAA;EACrB,CAAA;EAEAJ,SAAS,CAACC,GAAG,CAAC;;;;;;;;"}